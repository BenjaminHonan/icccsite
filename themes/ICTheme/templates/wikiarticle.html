{% extends "base.html" %}
{% block title %}{{ meta.title }} - {{ SITENAME }}{% endblock %}

{% block head %}<script src="{{ SITEURL }}/theme/js/wiki.js"></script>{% endblock %}

{% block banner %}{{ meta.title }}{% endblock banner %}

{% block content %}

<div class="article-content">

  <h1 class="article-title">{{ meta.title }}</h1>

  <nav><a class="wiki-nav-button">Expand Tree</a> / <a class="wiki-crumbs" href="{{ SITEURL }}/wiki/">Home</a>
  {% set breadcrumbs = path[1:].split("/") %}
  {% set total_path = SITEURL + "/wiki" %}
  {% for page in breadcrumbs %}
    {% set total_path = total_path + "/" + page %}
    {% if not loop.last %}
    / <a class="wiki-crumbs" href="{{ total_path }}">{{ page }}</a>
    {% endif %}
  {% endfor %}</nav>
  <nav class="wiki-nav">
    <ul class="wiki-links nodisplay">
    {% if subdirs is not none %}
    {% set level = 0 %}
    <li class="wiki-link"><a href="../">..</a></li>
    {% for subdir in subdirs %}
      {% if subdir.level > level %}
        {% set level = subdir.level %}
        <ul class="nodisplay">
      {% elif subdir.level < level %}
        {% for i in range(level - subdir.level) %}
          </ul>
        {% endfor %}
        {% set level = subdir.level %}
      {% endif %}
      {% if not loop.last %}
        {% if subdirs[loop.index].level > level %}
          <li class="wiki-link"><a href="{{ SITEURL }}/wiki/{{ subdir.path }}">{{ subdir.article.metadata.title }}</a> <a class="wiki-dir-expander">+</a></li>
        {% else %}
          <li class="wiki-link"><a href="{{ SITEURL }}/wiki/{{ subdir.path }}">{{ subdir.article.metadata.title }}</a></li>
        {% endif %}
      {% endif %}
    {% endfor %}
    {% else %}
      <li class="wiki-link"><a href="./">..</a></li>
    {% endif %}
    </ul>
  </nav>

  {{ content }}

  <p>
    {% if meta.autogen %}
    This is an autogenerated page. <a href="https://github.com/iccavingrepo/icccsite/new/master/content/wiki{{ meta.filepath }}">Create article.</a> Make sure to use {{ meta.title }}.md as the file name.<br>
    {% else %}
    <a href="https://github.com/iccavingrepo/icccsite/edit/master/content/wiki{{ meta.filepath }}">Edit page.</a><br>
    {% endif %}
    <a href="https://github.com/iccavingrepo/icccsite/new/master/content/wiki/">Add new page.</a>
  </p>

</div>



{% if meta.data is defined %}
<script style="display: none;" id="metadata" type="application/json">
  {
  {% for key in meta.data %}
  {% if loop.index > 1 %},{% endif %}
  """{{ key }}""":"""{{ meta.data[key] }}"""
  {% endfor %}
  }
</script>
{% endif %}
{% endblock %}
